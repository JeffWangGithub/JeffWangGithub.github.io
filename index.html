<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Glan Wang</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="CoderGC Glan Wang WGC">
<meta property="og:type" content="website">
<meta property="og:title" content="Glan Wang">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Glan Wang">
<meta property="og:description" content="CoderGC Glan Wang WGC">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Glan Wang">
<meta name="twitter:description" content="CoderGC Glan Wang WGC">
  
    <link rel="alternate" href="/atom.xml" title="Glan Wang" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Glan Wang</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">CoderGC</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/04/hello-world/" class="article-date">
  <time datetime="2016-06-04T05:28:37.000Z" itemprop="datePublished">2016-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/04/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/06/04/hello-world/" data-id="cip0q0iz90001pn163ml0q1na" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Mac/zsh不兼容的坑" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/31/Mac/zsh不兼容的坑/" class="article-date">
  <time datetime="2016-05-31T03:38:00.000Z" itemprop="datePublished">2016-05-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Mac/">Mac</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/31/Mac/zsh不兼容的坑/">zsh不兼容的坑-zsh:no matches found:</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>最近使用android的adb命令，<code>adb logcat *:E</code>使用该命令过来E级别的日志的时候，发现在zsh中提示无法找到这个命令<code>zsh: no matches found: *:E</code>。后来查看了一些资料才知道，这是由于zsh导致的。</p>
<p>###具体原因<br>因为zsh缺省情况下始终自己解释这个firefox*，而不会传递给adb logcat来解释。</p>
<p>###解决办法<br>在~/.zshrc中加入:<br>setopt no_nomatch, 然后进行source .zshrc命令</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/31/Mac/zsh不兼容的坑/" data-id="cip0q4qix0027rb16ae8tihwd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Gradle/gradle(一)" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/30/Gradle/gradle(一)/" class="article-date">
  <time datetime="2016-05-30T15:56:00.000Z" itemprop="datePublished">2016-05-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Gradle/">Gradle</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/30/Gradle/gradle(一)/">Gradle(一)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>###Task<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">###gradle基本语法</span><br><span class="line">基本语法认识文章(http://www.cnblogs.com/davenkin/p/gradle-learning-3.html)[http://www.cnblogs.com/davenkin/p/gradle-learning-3.html]</span><br><span class="line">task showDescription1 &lt;&lt; &#123;</span><br><span class="line">   description = &apos;this is task showDescription&apos;</span><br><span class="line">   println description</span><br><span class="line">&#125;</span><br><span class="line">task showDescription2 &lt;&lt; &#123;</span><br><span class="line">   println description</span><br><span class="line">&#125;</span><br><span class="line">showDescription2.description = &apos;this is task showDescription&apos;</span><br><span class="line">task showDescription3 &lt;&lt; &#123;</span><br><span class="line">   println description</span><br><span class="line">&#125;</span><br><span class="line">showDescription3 &#123;</span><br><span class="line">   description = &apos;this is task showDescription&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>以上3个Task完成的功能均相同，即先设置Task的description属性，在将其输出到命令行。</p>
<ol>
<li>对于每一个Task，Gradle都会在Project中创建一个同名的Property，所以我们可以将该Task当作Property来访问，showDescription2便是这种情况。另外，Gradle还会创建一个同名的方法，该方法接受一个闭包，我们可以使用该方法来配置Task，showDescription3便是这种情况。`</li>
<li>Groovy中的Bean和Java中的Bean有一个很大的不同，即Groovy为每一个字段都会自动生成getter和setter，并且我们可以通过像访问字段本身一样调用getter和setter</li>
<li>闭包的delegate代理机制。Gradle大量地使用了Groovy闭包的delegate机制。简单来说，delegate机制可以使我们将一个闭包中的执行代码的作用对象设置成任意其他对象</li>
</ol>
<p>###增量构建<br>1.如果我们将Gradle的Task看作一个黑盒子，那么我们便可以抽象出输入和输出的概念，一个Task对输入进行操作，然后产生输出。比如，在使用java插件编译源代码时，输入即为Java源文件，输出则为class文件。如果多次执行一个Task时的输入和输出是一样的，那么我们便可以认为这样的Task是没有必要重复执行的。此时，反复执行相同的Task是冗余的，并且是耗时的。<br>2.为了解决这样的问题，Gradle引入了<code>增量式构建的概念</code>。在增量式构建中，我们为<code>每个Task定义输入（inputs）和输入（outputs），如果在执行一个Task时，如果它的输入和输出与前一次执行时没有发生变化，那么Gradle便会认为该Task是最新的（UP-TO-DATE）</code>，因此Gradle将不予执行。<br>3.一个Task的inputs和outputs可以是一个或多个文件，可以是文件夹，还可以是Project的某个Property，甚至可以是某个闭包所定义的条件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">task combineFileContentIncremental &#123;</span><br><span class="line">   def sources = fileTree(&apos;sourceDir&apos;)</span><br><span class="line">   def destination = file(&apos;destination.txt&apos;)</span><br><span class="line">   inputs.dir sources</span><br><span class="line">   outputs.file destination</span><br><span class="line">   doLast &#123;</span><br><span class="line">      destination.withPrintWriter &#123; writer -&gt;</span><br><span class="line">         sources.each &#123;source -&gt;</span><br><span class="line">            writer.println source.text</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>第一次执行此task，gradle会完整的执行该task。但是输入输出没有改变的情况下再执行改task，combineFileContentIncremental<code>被标记为UP-TO-DATE</code>，表示该Task是最新的，Gradle将不予执行。在实际应用中，你将遇到很多这样的情况，因为Gradle的很多插件都引入了增量式构建机制。<br>如果我们修改了inputs（即sourceDir文件夹）中的任何一个文件或删除掉了destination.txt，当调用“gradle combineFileContentIncremental”时，Gradle又会重新执行，因为此时的Task已经不再是最新的了。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">:combineFileContentIncremental UP-TO-DATE</span><br><span class="line">BUILD SUCCESSFUL</span><br><span class="line">Total time: 2.104 secs</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/30/Gradle/gradle(一)/" data-id="cip0q0izq0004pn16zsz54xgb" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Mac/Httpie使用" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/29/Mac/Httpie使用/" class="article-date">
  <time datetime="2016-05-29T10:06:00.000Z" itemprop="datePublished">2016-05-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Mac/">Mac</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/29/Mac/Httpie使用/">Httpie使用</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>目前调试API接口的工具可以说多如红毛，chrome上的插件就又一大堆，使用哪个完全看个人的喜好。然而，如果你是一个命令控，那么恭喜你你可以继续向下看，如果你正在想成为一个命令控，你也可以下向下看。if you are UI Client user, you can go play!</p>
<p>###httpie的安装<br>这里只说一下Mac下的安装方式之一：直接使用brew命令来安装<br><code>brew install httpie</code> 静等安装完成即可</p>
<p>###httpie简单使用</p>
<ol>
<li>最简单的get请求<br><img src="~/QQ20160529-0@2x.png?r=90" alt=""></li>
<li>显示请求的详情加<code>-v</code><br><img src="~/18-13-33.jpg?r=84" alt=""></li>
<li>GET请求并携带参数<br>可以拼接到url后边，也可以让其自动拼接。 使用key==value时默认是GET请求，并把key=value拼接到url后边<br><code>http -v example.org username==glanwang password==123456</code>效果等同于参数自己拼装url后<br><img src="~/18-37-19.jpg?r=83" alt=""><br><img src="~/18-42-34.jpg?r=83" alt=""></li>
<li>修改请求头（包括修改UA） <code>header:value</code>形式<br><img src="~/18-17-46.jpg?r=83" alt=""></li>
<li>最简单的PUT/POST请求</li>
</ol>
<ul>
<li>使用<code>PUT/POST</code>关键字<br><img src="~/18-29-38.jpg?r=83" alt=""></li>
<li>后面添加<code>key=value</code>时默认是PUT请求（同时默认也是json提交）<br><img src="~/18-32-17.jpg?r=83" alt=""></li>
</ul>
<ol>
<li>模拟POST提交表单使用<code>--form POST</code>或者<code>-f POST</code><br><img src="~/18-48-13.jpg?r=83" alt=""></li>
<li>模拟文件上传表单<br>直接商官方的说明截图吧<br><img src="~/19-01-44.jpg" alt=""></li>
<li>模拟下载，类似于wget的功能<br><code>http --download https://github.com/jkbrzt/httpie/archive/master.tar.gz</code><br>下载此文件到当前目录<br><code>http --download https://github.com/jkbrzt/httpie/archive/master.tar.gz --output ~/Download/httpmaster.tar.gz</code><br>下载此文件到~/Download目录并命名为httpmaster.tar.gz</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/29/Mac/Httpie使用/" data-id="cip0q4qio0024rb16eyv7t5sd" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Java/Java反射大发" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/17/Java/Java反射大发/" class="article-date">
  <time datetime="2016-05-17T07:21:00.000Z" itemprop="datePublished">2016-05-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/17/Java/Java反射大发/">Java反射大发</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>俗话说的好：“无反射，无框架！”<br>最近由于频繁的对客户端打patch，无时无刻不用到反射，竟然发现原来写的反射工具类有bug。<br>总结一下使用反射的常见使用，本人语言组织能力极差，以下尽可能用代码说话<br>工具类源码下载地址：<a href="https://github.com/JeffWangGithub/ReflectUtil" target="_blank" rel="external">https://github.com/JeffWangGithub/ReflectUtil</a><br>————关于反射调用方法————–</p>
<ol>
<li><p>获取方法Method对象</p>
<ul>
<li>Class.getMethod()此方法只能获取到public的方法</li>
<li><p>Class.getDeclaredMethod()此方法可以获取到所有的方法，没有修饰符的影响<br>注意：从效率上讲，getDeclaredMethod()方法的效率是比getMethod()低的，因此如果知道需要获取的Method的修饰符，最好选择效率高的方法。<br>通用的方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 获取某个类声明的Method对象，会依次寻找当前类和其父类，找到则返回</span><br><span class="line"> */</span><br><span class="line">public static Method getDeclaredMethod(Class&lt;?&gt; clazz, String methodName,</span><br><span class="line">                                       Class&lt;?&gt;... parameterTypes) &#123;</span><br><span class="line">    if(clazz != null)&#123;</span><br><span class="line">        //从当前类开始寻找，依次想其父类开始寻找，知道找到为止</span><br><span class="line">        for (; Object.class != clazz; clazz = clazz.getSuperclass())&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                Method declaredMethod = clazz.getDeclaredMethod(methodName, parameterTypes);</span><br><span class="line">                if(declaredMethod != null)&#123;</span><br><span class="line">                    declaredMethod.setAccessible(true);</span><br><span class="line">                    return declaredMethod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (NoSuchMethodException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>获取某个类的父类的方法Mehod对象：不需要过多解释了吧，看懂上面的你肯定就会这个了。</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 获取父类的方法</span><br><span class="line"> */</span><br><span class="line">public static Method getSuperMethod(Class&lt;?&gt; currentClazz, String methodName, Class&lt;?&gt;... parameterTypes)&#123;</span><br><span class="line">    if(currentClazz != null &amp;&amp; currentClazz.getSuperclass() != Object.class)&#123;</span><br><span class="line">    </span><br><span class="line">        for(currentClazz = currentClazz.getSuperclass(); Object.class != currentClazz ; currentClazz = currentClazz.getSuperclass())&#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                Method declaredMethod = currentClazz.getDeclaredMethod(methodName, parameterTypes);</span><br><span class="line">                if(declaredMethod != null)&#123;</span><br><span class="line">                    declaredMethod.setAccessible(true);</span><br><span class="line">                    return declaredMethod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; catch (NoSuchMethodException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用super方法，即调用父类的方法</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 调用当前对象父类的方法，即super方法</span><br><span class="line"> */</span><br><span class="line">public static Object invokeSuperMethod(Object currentObject, String methodName, Class&lt;?&gt;... parameterTypes) throws Exception &#123;</span><br><span class="line">    if(currentObject != null)&#123;</span><br><span class="line">        Method superMethod = getSuperMethod(currentObject.getClass(), methodName, parameterTypes);</span><br><span class="line">        if(superMethod != null)&#123;</span><br><span class="line">            superMethod.setAccessible(true);</span><br><span class="line">            return  superMethod.invoke(currentObject, parameterTypes);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    throw new Exception(&quot;invoke method fail&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用方法</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    /**</span><br><span class="line"> *调用当前对象的方法，可用于静态和非静态方法</span><br><span class="line"> */</span><br><span class="line">public static Object invokeMethod(Object object, String methodName,</span><br><span class="line">                                  Class&lt;?&gt;[] parameterTypes, Object[] paramValues) throws Exception &#123;</span><br><span class="line">    Method method = getDeclaredMethod(object.getClass(), methodName,</span><br><span class="line">            parameterTypes);</span><br><span class="line">    if (method != null) &#123;</span><br><span class="line">        return method.invoke(object, paramValues);</span><br><span class="line">    &#125;</span><br><span class="line">    throw new Exception(&quot;invoke method fail&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>调用静态方法(private、public或protected)<br> 调用时直接使用invoke(null, parameterTypes)即可，当然此处使用一个对象也没有问题, API的解释为<code>If the underlying method is static, then the specified obj argument is ignored. It may be null.</code></p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 调用静态方法</span><br><span class="line"> */</span><br><span class="line">public static Object invokeStaticMethod(Object object, String methodName,</span><br><span class="line">                                  Class&lt;?&gt;[] parameterTypes, Object[] paramValues) throws Exception &#123;</span><br><span class="line">    if(object != null)&#123;</span><br><span class="line">        Method method = getDeclaredMethod(object.getClass(), methodName,</span><br><span class="line">                parameterTypes);</span><br><span class="line">        if (method != null) &#123;</span><br><span class="line">            method.setAccessible(true);</span><br><span class="line">            return method.invoke(null, paramValues);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    throw new Exception(&quot;invoke method fail&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>——————关于字段———————-</p>
<ol>
<li><p>获取字段</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">private static Field getDeclaredField(Class&lt;?&gt; clazz, String fieldName) &#123;</span><br><span class="line">    if (clazz != null) &#123;</span><br><span class="line">        StringBuffer stringBuffer = new StringBuffer();</span><br><span class="line">        stringBuffer.append(clazz.getName());</span><br><span class="line">        stringBuffer.append(fieldName);</span><br><span class="line">        String key = stringBuffer.toString();</span><br><span class="line">        if (fieldCache.containsKey(key)) &#123;</span><br><span class="line">            return fieldCache.get(key);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            Field field = null;</span><br><span class="line">            for (; clazz != Object.class; clazz = clazz.getSuperclass()) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    field = clazz.getDeclaredField(fieldName);</span><br><span class="line">                    field.setAccessible(true);</span><br><span class="line">                    fieldCache.put(key, field);</span><br><span class="line">                    return field;</span><br><span class="line">                &#125; catch (Exception e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取某个对象的某个字段的值</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 根据Object对象获取Object中的fieldValue，一般用作获取非静态字段</span><br><span class="line"> * @param object</span><br><span class="line"> * @param fieldName</span><br><span class="line"> * @return</span><br><span class="line"> * @throws Exception</span><br><span class="line"> */</span><br><span class="line">public static Object getFieldValue(Object object, String fieldName)</span><br><span class="line">        throws Exception &#123;</span><br><span class="line">    Field field = getDeclaredField(object.getClass(), fieldName);</span><br><span class="line">    if (field != null) &#123;</span><br><span class="line">        return field.get(object);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        throw new Exception(&quot;getFieldValue fail&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>给某个对象的某个字段设置value    </p>
<pre><code>public static void setFieldValue(Class&lt;?&gt; clazz, String fieldName,
                                 Object value) throws Exception {
    Field field = getDeclaredField(clazz, fieldName);
    if (field != null) {
        field.set(null, value);
    } else {
        throw new Exception(fieldName+&quot; fail&quot;);
    }
}
</code></pre></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/17/Java/Java反射大发/" data-id="cip0q4uxa002crb16uf8y1k95" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Java/性能观察: Trove 集合类（转）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/16/Java/性能观察: Trove 集合类（转）/" class="article-date">
  <time datetime="2016-05-16T07:09:00.000Z" itemprop="datePublished">2016-05-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/16/Java/性能观察: Trove 集合类（转）/">性能观察: Trove 集合类（转）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Trove4j一个轻量的高性能的java集合库<br><a href="http://www.ibm.com/developerworks/cn/java/j-perf09284.html" target="_blank" rel="external">http://www.ibm.com/developerworks/cn/java/j-perf09284.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/16/Java/性能观察: Trove 集合类（转）/" data-id="cip0q3q2x0006rb16dhi4487r" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android/Android流行框架(盗图一张)" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/05/07/Android/Android流行框架(盗图一张)/" class="article-date">
  <time datetime="2016-05-07T10:26:00.000Z" itemprop="datePublished">2016-05-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/07/Android/Android流行框架(盗图一张)/">Android流行框架(盗图一张)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="~/xJnVaP4.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/05/07/Android/Android流行框架(盗图一张)/" data-id="cip0q411d000krb16cr6n7cwj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android/Gradle相关" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/05/Android/Gradle相关/" class="article-date">
  <time datetime="2016-04-05T03:34:00.000Z" itemprop="datePublished">2016-04-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/05/Android/Gradle相关/">Gradle相关</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>基础Java项目有一组有限的task用于互相处理生成一个输出。 classes是一个编译Java源代码的task。可以在build.gradle文件中通过脚本很容易使用classes。这是project.tasks.classes的缩写。<br>在Android项目中，相比之下这就有点复杂。因为Android项目中会有大量相同的task，并且它们的名字基于Build Types和Product Flavor生成。<br>为了解决这个问题，android对象有两个属性：</li>
</ol>
<ul>
<li>applicationVariants（只适用于app plugin）</li>
<li>libraryVariants（只适用于library plugin）</li>
<li>testVariants（两个plugin都适用）<br>这三个都会分别返回一个ApplicationVariant、LibraryVariant和TestVariant对象的DomainObjectCollection（<code>域名对象集合</code>）。<br>DomainObjectCollection可以直接访问所有对象，或者通过过滤器进行筛选。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">android.applicationVariants.each &#123; variant -&gt;</span><br><span class="line">    ....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>这三个variant类都共享下面的属性：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>属性类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>String</td>
<td>Variant的名字，必须是唯一的。</td>
</tr>
<tr>
<td>description</td>
<td>String</td>
<td>Variant的描述说明。</td>
</tr>
<tr>
<td>dirName</td>
<td>String</td>
<td>Variant的子文件夹名，必须也是唯一的。可能也会有不止一个子文件夹，例如“debug/flavor1”</td>
</tr>
<tr>
<td>baseName</td>
<td>String</td>
<td>Variant输出的基础名字，必须唯一。</td>
</tr>
<tr>
<td>outputFile</td>
<td>File</td>
<td>Variant的输出，这是一个可读可写的属性。</td>
</tr>
<tr>
<td>processManifest</td>
<td>ProcessManifest</td>
<td>处理Manifest的task。</td>
</tr>
<tr>
<td>aidlCompile</td>
<td>AidlCompile</td>
<td>编译AIDL文件的task。</td>
</tr>
<tr>
<td>renderscriptCompile</td>
<td>RenderscriptCompile</td>
<td>编译Renderscript文件的task。</td>
</tr>
<tr>
<td>mergeResources</td>
<td>MergeResources</td>
<td>混合资源文件的task。</td>
</tr>
<tr>
<td>mergeAssets</td>
<td>MergeAssets</td>
<td>混合asset的task。</td>
</tr>
<tr>
<td>processResources</td>
<td>ProcessAndroidResources</td>
<td>处理并编译资源文件的task。</td>
</tr>
<tr>
<td>generateBuildConfig</td>
<td>GenerateBuildConfig</td>
<td>生成BuildConfig类的task。</td>
</tr>
<tr>
<td>javaCompile</td>
<td>JavaCompile</td>
<td>编译Java源代码的task。</td>
</tr>
<tr>
<td>processJavaResources</td>
<td>Copy</td>
<td>处理Java资源的task。</td>
</tr>
<tr>
<td>assemble</td>
<td>DefaultTask</td>
<td>Variant的标志性assemble task。</td>
</tr>
</tbody>
</table>
<p>ApplicationVariant类还有以下附加属性：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>属性类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>buildType</td>
<td>BuildType</td>
<td>Variant的BuildType。</td>
</tr>
<tr>
<td>productFlavors</td>
<td>List</td>
<td>Variant的ProductFlavor。一般不为空但也允许空值。</td>
</tr>
<tr>
<td>mergedFlavor</td>
<td>ProductFlavor</td>
<td>android.defaultConfig和variant.productFlavors的合并。</td>
</tr>
<tr>
<td>signingConfig</td>
<td>SigningConfig</td>
<td>Variant使用的SigningConfig对象。</td>
</tr>
<tr>
<td>isSigningReady</td>
<td>boolean</td>
<td>如果是true则表明这个Variant已经具备了所有需要签名的信息。</td>
</tr>
<tr>
<td>testVariant</td>
<td>BuildVariant</td>
<td>将会测试这个Variant的TestVariant。</td>
</tr>
<tr>
<td>dex</td>
<td>Dex</td>
<td>将代码打包成dex的task。如果这个Variant是个库，这个值可以为空。</td>
</tr>
<tr>
<td>packageApplication</td>
<td>PackageApplication</td>
<td>打包最终APK的task。如果这个Variant是个库，这个值可以为空。</td>
</tr>
<tr>
<td>zipAlign</td>
<td>ZipAlign</td>
<td>zip压缩APK的task。如果这个Variant是个库或者APK不能被签名，这个值可以为空。</td>
</tr>
<tr>
<td>install</td>
<td>DefaultTask</td>
<td>负责安装的task，不能为空。</td>
</tr>
<tr>
<td>uninstall</td>
<td>DefaultTask</td>
<td>负责卸载的task。</td>
</tr>
</tbody>
</table>
<p>LibraryVariant类还有以下附加属性：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>属性类型</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>buildType</td>
<td>BuildType</td>
<td>Variant的BuildType.</td>
</tr>
<tr>
<td>mergedFlavor</td>
<td>ProductFlavor</td>
<td>The defaultConfig values</td>
</tr>
<tr>
<td>testVariant</td>
<td>BuildVariant</td>
<td>用于测试这个Variant。</td>
</tr>
<tr>
<td>packageLibrary</td>
<td>Zip</td>
<td>用于打包库项目的AAR文件。如果是个库项目，这个值不能为空。</td>
</tr>
</tbody>
</table>
<ol>
<li>BuildType是gradle中的一个类型和String等类型一样<br>BuildType类型的属性和方法<a href="http://google.github.io/android-gradle-dsl/1.3/com.android.build.gradle.internal.dsl.BuildType.html" target="_blank" rel="external">http://google.github.io/android-gradle-dsl/1.3/com.android.build.gradle.internal.dsl.BuildType.html</a><figure class="highlight plain"><figcaption><span>buildType = project.android.applicationVariants.buildType```</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 修改debug版的包名达到可以relase和debug包同时存在</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>buildTypes {<br>        release {<br>            debuggable false<br>            minifyEnabled false<br>            proguardFiles getDefaultProguardFile(‘proguard-android.txt’), ‘proguard-rules.pro’<br>            signingConfig signingConfigs.release<br>        }<br>        debug {<br>            applicationIdSuffix “.testdebug” //给debug版applicationId增加.testdebug后缀，以便可以同时存在多个版本<br>            minifyEnabled false<br>            proguardFiles getDefaultProguardFile(‘proguard-android.txt’), ‘proguard-rules.pro’</p>
<pre><code>    }
}
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">final def variants = project.android.applicationVariants</span><br><span class="line"></span><br><span class="line">//使用variant代替了it参数</span><br><span class="line">variants.all&#123; variant -&gt;</span><br><span class="line">    def buildType = variant.buildType</span><br><span class="line">    def defaultCharset = java.nio.charset.Charset.defaultCharset().toString()</span><br><span class="line">    def appName = &quot;GTapp&quot;</span><br><span class="line">    //更改debug包的包名</span><br><span class="line">    if(buildType.applicationIdSuffix)&#123;//applicationIdSuffix属性有值</span><br><span class="line">        variant.mergeResources.doLast&#123;</span><br><span class="line">            def f = file(&quot;$&#123;buildDir&#125;/intermediates/res/merged/$&#123;buildType.getName()&#125;/values/values.xml&quot;)</span><br><span class="line">            String content = f.getText(defaultCharset)</span><br><span class="line">            content = content.replaceAll(appName,appName+buildType.applicationIdSuffix)</span><br><span class="line">            f.write(content, defaultCharset)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/04/05/Android/Gradle相关/" data-id="cip0q411m000trb16fnyd030q" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android/android手机修改hosts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/30/Android/android手机修改hosts/" class="article-date">
  <time datetime="2016-03-30T08:43:00.000Z" itemprop="datePublished">2016-03-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/30/Android/android手机修改hosts/">android手机修改hosts</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>方法一：ADB 命令行替换法<br>将手机中的hosts文件先pull到电脑上，然后修改，最后push进手机<br>在Android下，/etc是link到/system/etc的，我们需要修改/system/etc/hosts来实现。但是这个文件是只读，不能通过shell直接修改</p>
<p>为方便操作，可以将压缩包中的adb1程序连文件夹解压缩到C盘。<br>步骤如下：<br>1、获得root权限：adb root<br>2、设置/system为可读写：adb remount<br>3、将hosts文件复制到PC：adb pull /system/etc/hosts （此时adb文件夹下已经有了复制到PC上的hosts文件）<br>4、修改PC机上文件<br>5、将PC机上文件复制到手机：adb push hosts /system/etc/hosts<br>如果要查看是否修改成功，可以在PC上执行adb shell，运行cat /system/etc/hosts；或者在手机上运行cat /system/etc/hosts。<br>方法二：简单粗暴：在手机上下载RE文件管理器，直接修改</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/30/Android/android手机修改hosts/" data-id="cip0q4129001drb16bxalgx9a" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Android/AspectJ与Patch" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/03/21/Android/AspectJ与Patch/" class="article-date">
  <time datetime="2016-03-21T08:03:00.000Z" itemprop="datePublished">2016-03-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/21/Android/AspectJ与Patch/">AOP编程之AspectJ与Patch</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>htt###AOP—AspectJ简介<br>相关文章</p>
<ul>
<li>简介入门：<a href="http://blog.csdn.net/kanglix1an/article/details/43764801?foxhandler=RssReadRenderProcessHandler" target="_blank" rel="external">http://blog.csdn.net/kanglix1an/article/details/43764801?foxhandler=RssReadRenderProcessHandler</a></li>
<li>官方网站：<br><a href="http://www.eclipse.org/aspectj/docs.php" target="_blank" rel="external">http://www.eclipse.org/aspectj/docs.php</a></li>
<li>patch使用到的aop知识<br><a href="http://blog.csdn.net/zl3450341/article/details/7673950" target="_blank" rel="external">http://blog.csdn.net/zl3450341/article/details/7673950</a></li>
<li>优势：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 发生在编译时期, 因此效率不是问题。由于是编译时期进行注入，所有效率不是大问题，现在比较流行的注入框架很多都是编译时期来处理的，这样比运行时要高效.</span><br><span class="line">2. 完全兼容java语言语法。即又自己的语法关键字，又可以完全使用java 语言关键字，与java 一起使用绝逼是吊炸天。</span><br><span class="line">3. 最低的侵入性。对原生代码的形如行很低。</span><br></pre></td></tr></table></figure>
<p>###代码介绍实现思路<br>关键点：1.patch类的剥离；2. 混淆导致的问题；</p>
<p>###patch打包步骤<br>patch打包步骤</p>
<ol>
<li>将发版时候的mapping.txt 复制到当前目录<br>确认当前目录AndroidManifest.xml里面的android:versionCode以及ndroid:versionName跟线上版本一致</li>
<li>目前暂时使用Android插件’com.android.tools.build:gradle:1.3.0’版本，更改buildscript中的android插件版本本为1.3.0</li>
<li>假设要打patch的类为xx.java 在同目录创建名字为xxPatch.java的patch文件（尽量这样子 同包可以通过非反射方式使用原有类的更多功能）</li>
<li><p>patch的一个demo</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">public class PicShowFragmentPatch &#123;</span><br><span class="line">    private String TAG = &quot;PicShowFragmentPatch&quot;;</span><br><span class="line"></span><br><span class="line">    private PicShowFragment mTarget;</span><br><span class="line"></span><br><span class="line">    public void setTarget(PicShowFragment target) &#123;</span><br><span class="line">        mTarget = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @PatchAnnotation(value = &quot;public void com.netease.nr.biz.pics.PicShowFragment.onCreate(android.os.Bundle)&quot;, intercept = &quot;after&quot;)</span><br><span class="line">    public void onCreate(android.os.Bundle bundle)&#123;</span><br><span class="line">        Toast.makeText(mTarget.getContext(), &quot;onCreate patch stat&quot;, Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @PatchAnnotation(value = &quot;public void com.netease.nr.biz.pics.PicShowFragment.onViewCreated(android.view.View, android.os.Bundle)&quot;, intercept = &quot;after&quot;)</span><br><span class="line">    public void onViewCreated(android.view.View view,android.os.Bundle b)&#123;</span><br><span class="line">        Toast.makeText(mTarget.getContext(), &quot;onViewCreated patch stat&quot;, Toast.LENGTH_LONG).show();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**注意：如果需打patch的类被混淆过 @PatchAnnotation 的信息需要填写混淆过之后的对应路径</span><br><span class="line">     * #before  先执行patch代码逻辑 再执行原代码逻辑</span><br><span class="line">     * #replace 只执行patch代码逻辑</span><br><span class="line">     * #after	 先执行原代码逻辑  再执行patch代码逻辑 </span><br><span class="line">     */</span><br><span class="line">    @PatchAnnotation(value = &quot;public void com.netease.nr.biz.pics.PicShowFragment.onLocalLoadFinished(java.lang.Object)&quot;, intercept = &quot;after&quot;)</span><br><span class="line">    public void onLocalLoadFinished(Object object)&#123;</span><br><span class="line">        Toast.makeText(mTarget.getContext(), &quot;onLocalLoadFinished patch stat&quot;, Toast.LENGTH_LONG).show();</span><br><span class="line">        try &#123;</span><br><span class="line">            //修改本地的数据源，变味全景图片</span><br><span class="line">            List&lt;Map&lt;String, Object&gt;&gt; list = (List&lt;Map&lt;String, Object&gt;&gt;) ReflectUtil.getFieldValue(mTarget, &quot;w&quot;);</span><br><span class="line">            if(list != null)&#123;</span><br><span class="line">                Logger.d(&quot;PicShowFragmentPatch&quot;, &quot;list.size() ==&quot; + list.size());</span><br><span class="line">                for (int i = 0; i &lt; list.size(); i++) &#123;</span><br><span class="line">                    Map&lt;String, Object&gt; map = list.get(i);</span><br><span class="line">                    map.put(PicShowModel.PAPA_PANO_IMG_URL, map.get(PicShowModel.PARA_IMG_URL));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @PatchAnnotation(value = &quot;private void com.netease.nr.biz.pics.PicShowFragment.initAdapter()&quot;,intercept = &quot;before&quot;)</span><br><span class="line">    private void initAdapter() &#123;</span><br><span class="line">        Toast.makeText(mTarget.getContext(), &quot;initAdapter patch before&quot;, Toast.LENGTH_LONG).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>studio 菜单项 Build 依次执行Clean Project,Generate Signed Apk(选patch)</p>
</li>
<li>将导出的apk 重命名,并进行本地验证</li>
<li>在本地测试patch包的方式：将patch包放到”/sdcard/netease/test_patch.apk”目录下，并且命名必须是test_patch.apk</li>
<li>上传服务器进行验证</li>
</ol>
<p>###需要注意的小细节</p>
<ul>
<li>有关内部类和成员变量私有化影响效率</li>
<li><p>有关混淆配置的介绍 <a href="http://www.kaiyuanba.cn/html/1/131/138/7820.htm" target="_blank" rel="external">http://www.kaiyuanba.cn/html/1/131/138/7820.htm</a></p>
</li>
<li><p>打patch包的步骤：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. copy mapping.txt文件到所需目录</span><br><span class="line">2. clean工程</span><br><span class="line">3. 打patch包</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>步骤不能变化，否则打出来的patch包会又问题</p>
<ul>
<li>发版时必须保存编译的mapping文件</li>
<li>引入    useLibrary ‘org.apache.http.legacy’包导致补丁能拦截此包中类名中含有patch的类</li>
<li>打patch复杂度搞，但是稳定性好，不受android版本限制</li>
</ul>
<p>###AspectJ相关小知识<br>AspectJ切面变成学习blog地址：<br><a href="http://blog.csdn.net/column/details/aspectj.html" target="_blank" rel="external">http://blog.csdn.net/column/details/aspectj.html</a></p>
<ol>
<li>AspectJ的Execution表达式。execution捕获的则是执行点,<br>另外还有一个call表示调用的地方，execution标识执行的地点。</li>
</ol>
<ul>
<li><p>call与execution的区别请参考<a href="http://blog.csdn.net/zl3450341/article/details/7673960" target="_blank" rel="external">http://blog.csdn.net/zl3450341/article/details/7673960</a></p>
</li>
<li><p>Execution表达式相关内容请参考<a href="http://blog.csdn.net/yakoo5/article/details/17001381" target="_blank" rel="external">http://blog.csdn.net/yakoo5/article/details/17001381</a></p>
</li>
</ul>
<p>###题外话<br>类插件化</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/03/21/Android/AspectJ与Patch/" data-id="cip0q411i000prb16qxuba2if" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Gradle/">Gradle</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2016/06/04/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2016/05/31/Mac/zsh不兼容的坑/">zsh不兼容的坑-zsh:no matches found:</a>
          </li>
        
          <li>
            <a href="/2016/05/30/Gradle/gradle(一)/">Gradle(一)</a>
          </li>
        
          <li>
            <a href="/2016/05/29/Mac/Httpie使用/">Httpie使用</a>
          </li>
        
          <li>
            <a href="/2016/05/17/Java/Java反射大发/">Java反射大发</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 GlanWang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>